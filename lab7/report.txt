

Abstract
   In a subsea engineering project, a circular cylindrical vessel is an ideal container for electrical components. The capacity and shape of this container is relatively limited because of water pressure and the cost of manufacturing. Due to the characteristics of this structure, the designers have to compress the space for electrical circuits implement as much as possible on the basis of ensuring the function and heat dissipation. For the consideration of time, the 2-D circuit simulation with 3-D mechanical simulation are needed for there’s spatial limitation on module’s height and container’s margin. Since temperature is an important factor that influence the power density of transformer, thermal simulation is also needed in the designing of transformer in order to optimize the transformer. The subsea electricity transmission relies on the high voltage direct current transformation which requires a Modular Multilevel Converter (MMC) to execute DC/AC conversion so that the transformer can lower the voltage. The parameters of this transformer including the material of the core and the number of the coil layers should be optimized to reduce loss and increase the power density. 
    In another uninterruptible power system (UPS) project, a five-voltage-level rectifier circuit based on neural-point-clamped and floating capacitors has been adopted to provide high voltage direct current which does AC/DC conversion. Consequently, the loss calculation will be necessary to evaluate the performance of this circuit. The work we did was about making the loss calculation more efficient.
Background
   Studies in power electronic are always involved in conditions of high voltage and high power. In the application of subsea environment in the first project, direct current power transmission will be better for the service life of submarine cables. To lower the voltage for the electronic components which work under 375V, an DC/AC conversion would be necessary so that the transformer can lower the voltage. The Modular Multilevel Converter (MMC) will convert the 15KV direct current from submarine cable to ±4.5kV, 10kHz square wave and the transformer can convert it to 375V. However, the challenges of this high voltage, high frequency and power density transformer lie in the unneglectable core loss and winding loss caused by factors including the skin and proximity effects [1]. Hence loss calculation would be critical in the optimization of the transformer. Previously Mathcad which can intuitively calculate the loss based on mathematical functions was used in Professor Li Chushan’s team. Mathcad is an ideal tool for people to read the functions in a mathematical style. However, Mathcad’s calculation is of low efficiency. Our job was to understand the mechanism of transformer and write another code in Matlab which can calculate faster and generate larger set of inputs to replace the Mathcad calculation platform. Zhu Zhongbo and Wang Xiwei were finally responsible for this job. The differences of two calculation platforms are shown in Fig. 1. 

   Rectifier’s function of AC-DC conversion is realized by controlling the switches. By comparing the voltage triangular carrier wave and the sine wave form the power grid, switches can be turned on and off in a specific order which consequently introduced two losses: conduction loss and switching loss. Loss calculation is a crucial criterion of evaluating the performance of this rectifier and this task was accomplished using Mathcad which is of low efficiency. Zhu Zhongbo and Wang Xiwei were responsible for writing high-performance Matlab code to shorten the time needed for each loss calculation process.
Methods and Contributions
Mathematical Modelling
Optimized Transformers
   In this transformer, bundles of litz wires formed electromagnetic coils which shared the same magnetic core consisting of stacks of ferrite or nanocrystalline. Isolation material wraps around transformer’s electromagnetic coils which prevents the interference between the first and secondary sides of the transformer. Some parameters of this transformer are fixed including the magnetic core material (ferrite or nanocrystalline) and the Insulating material. However, some parameters of the transformer are yet to be determined including the number of litz bundle turns per layer in the primary winding portion, the number of  magnetic core stacks and the maximum allowed current density through the conductor called J_max [1]. The loss calculation should try the combinations of all the free parameters and get the optimized result which includes the highest power density, efficiency and the lowest temperature rise. In order to calculate the loss, the geometry of transformer should be determined. Core losses and winding losses can be specified in analytical methods. To estimate the temperature rise, an equivalent thermal network has been adopted in the mathematical model. The transformer’s design, the loss calculating algorithm and  theoretical  thermal model are shown in the Fig. 6 [1].
   Since the transformer has fixed parameters and free parameters, calculating every combination of these parameters puts forward relatively high requirement of calculating efficiency. In addition to this, Mathcad can only calculate the output for one set of input each time which is also a defect of this platform. To deal with this defect, researchers used to make use of Mathcad plug-in in Excel to try out different parameter combinations, but the calculating pressure will inevitably be heavier. Matlab not only improves the calculating efficiency but also makes the whole calculating work easier to do for researchers’ future use. 
   

Transformer’s design. Calculation algorithm. Equivalent thermal network for the transformer.
   With the basic understanding of the optimization and calculation process, it’s possible to transfer the calculation platform from Mathcad to Matlab. The calculating task can be divided into three parts, which are the codes to generate combinations of all possible inputs, calculating the result and the codes to visualize the results varying by different free parameters. With nested loops in the input generation code, the brute force method will allow researchers to quickly generate combinations of free parameters which can be fed into a calculation function in which the loss calculation and equivalent thermal model calculation are implemented to obtain a set of outputs including power density, efficiency and temperature rise for each specific set of input. These data will automatically be saved in the CSV file for further data analysis in Excel. The code for visualizing the results will plot a 2D scatter points graph. With this 2D graph whose x axis represents power density (KW/L), y axis represents efficiency and the colors of points represents the temperature rise, people can get an intuitive result of the optimization. Points in the upper right corner of the graph represents the best combination of transformer parameters and how points are distributed in the graph can tell us about the performance of different magnetic core materials. As is shown in Fig. 7, the optimized condition for a transformer with ferrite as its material of magnetic core has an efficiency more than 99.75% and the power density more than 40KW/L and also the temperature rise less than 40 degree Celsius. The complete code is available on Github with the link: https://github.com/zzb66666666x/Optimized-Transformer.git 

Efficiency-Power density graph for a transformer with ferrite magnetic core.
   With the new Matlab calculation platform, the calculation efficiency is thousands of times higher which is the major contribution we did. Previously, the inputs were generated in Excel by hand and calculating the results for 1000 sets of input may take more than 10 minutes. Now, more than 17000 sets of inputs will be processed and save the outputs within 10 seconds.
Calculating Switching- and Conduction-Losses of Five-level Three-phase Circuits
   Transplanting Mathcad equations into MATLAB functions for the semiconductor losses and efficiency of a 5-Level HANPC rectifier is similar with transformers, and there is only one point worth mentioning. As shown in Fig. 8, for each set of free variables, the situation of tens of thousands of time pieces is required for calculation and there are also dozens of equations with condition, so “for” iteration and “if” switch are needed in MATLAB codes, which MATLAB is not good at and slow down the calculation. However, since MATLAB is good at matrix calculation, as shown in Fig. 9, during programming, matrix methods are applied to instead “for” and “if” and keep MATLAB calculating fast. In real tests, the time needed for more than 40000 sets input combinations was reduced form 10 minutes to 2 minutes.

MATLAB Codes for the Semiconductor Losses and Efficiency of A 5-Level HANPC Rectifier.
   The complete code is available in Github with the link
Control Unit Learning – DSP and FPGA
   As for DSP, Zhu Zhongbo and Wang Xiwei learned basic knowledge varying from system control, interrupts, external interface (XINTF) and enhanced pulse width modulator (ePWM). We find that by reading and writing registers in DSPs, programmers could control DSPs through example programs. With the help of controlSUITE which has plenty of example source code released by Texas Instruments to help developer save time. We managed to use DSP to generate a PWM wave, which is shown in Fig. 10. 
   
 A PWM Wave Generated by DSP.
   It’s relatively complex to generate this PWM wave by DSP because this wave was based on the interrupt mechanism of DSP. There are 58 interrupt sources for DSP while the chip doesn’t posses that many interrupt lines. The solution is to adopt the three-stage interrupt mechanism which basically means that the interrupt sources will be divided by groups and the external interrupt source should trigger the PIE (peripheral interrupt expansion) interrupt  first before halting the CPU. By defining three GPIO pins with the first one to generate interrupt signal, the second one to accept this signal to trigger CPU’s feedback and third one for oscilloscope’s input. Once the second pin detects interrupt signal generated by the first pin, the CPU will instruct the third pin to output one high voltage. Otherwise, the output of the third pin will be set low. Above is the basic logic of what we did to monitor the PWM wave generated by DSP.
   When it comes to FPGA, guided by ECE 385 Lab, first and foremost, System Verilog, both a hardware description language (HDL) and a hardware verification language (HDVL), was introduced, which is shown in Fig. 11. Secondly, a 2-bit adder including two full-adders was obtained with FPGA, which is shown in Fig. 12.

Codes of A Single Full-Adder. (b) Codes of A 2-Bit Adder. 
   As is shown in Fig. 12 (a) which is a 2-bit adder, three LEDs represent the three bits of output. The left four switches represent two 2 bits input A and B. The switch in the rightmost represents the remainder called C_in. The calculation shown in the picture can be translated as 11 + 11 + 01 = 111 (in binary style).
Mechanical Design
   Based on the elements list of requirements, manuals for each component was searched to obtain initial dimension in width, length and height. To be more precise, the possible fabrication error of component size was imbedded. Some build-up sections were simplified to avoid assembly error and improve efficiency. Fig. 13 has shown the original appearance of a duo diode and initial dimension in the manual while Fig. 14 shows the manufactured product. 
   

 Real Product of Duo diode. (b) Three view of the diode.
   In relation to the larger costs on time when using circuit simulation, 3-D modeling is more convenience and changeable with reusable components and separable layer, which could be used to verify the validity of hypothetic model, only needs being roughly described the arrangement. Fig. 15 shows the isolated disk and elements used for assumptions’ verification.
   

Thermal Simulation Tests
   Finite element analysis uses mathematical approximation to simulate real physical systems, which is a widely used and efficient numerical analysis method. By making simulation instead of actual product, design costs and time cost can be reduced and meanwhile the performance of electronic products can be improved. For the need of thermal modeling in this project, Ansys Icepak is used to carry out the thermal simulation of the transformer, which utilizes the finite element method to analyze. Icepak is a professional thermal analysis software which can solve various heat dissipation problems at different scales. With advanced meshing technology, rich physical models that include heat conduction, convection and radiation, as well as powerful solution function, Icepak enables accurate thermal simulation that can meet the requirement of the project.
   The process of thermal simulation in Icepak includes modeling, meshing, calculating and postprocessing. Use SolidWorks to establish the model of the transformer and then import into Icepak and transfer CAD model to Icepak model. In the meshing part, first make coarse mesh and then finer mesh, make refining according to the mesh check function until the transformer is subdivided into finite elements properly. Set the core material as ferrite, the heat conductivity is 4 and set the winding material as copper. In the calculating part, when the solution residuals graph is convergent, the calculation is done. The postprocessing part then shows the result of calculation by nice graphs, including the object face and plane cut contours that show the temperature distribution of the transformer.
   In conclusion, the volume temperature distribution and plane cut were obtained to simulate the heating condition of the transformer and determine whether the heating condition of the transformer meets the requirements. The heat distribution of the object face and plane cut are shown in the Fig. 18. Researchers can change the parameters of the thermal simulation process to obtain different analytical simulation value under different conditions which is the major contribution of Yao’s work.

The temperature distribution of the object face. (b) The temperature distribution of the plane cut.
Acknowledge
   First of all, we would like to extend our sincere gratitude to our professor, Prof. Li Chushan, for the precious opportunity offered by him and his enthusiasm as well as diligence towards his research in power electronics.
   Secondly, high tribute should be paid to Prof. Li’s graduates, Mr. Lu Rui and Mr. Zhang Yifan, who teaches us valuable knowledge and techniques repeatedly and patiently.
   Last our thanks would go to ZJU-UIUC Institute and Sustainable & Efficient Electric Energy Delivery Systems Laboratory (SEEEDS) in ZJU, which organize or participate in such significant research program.


